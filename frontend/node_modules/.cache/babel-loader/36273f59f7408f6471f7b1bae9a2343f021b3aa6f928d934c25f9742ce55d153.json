{"ast":null,"code":"import { asyncMap } from \"../../utilities/index.js\";\nexport default function subscribeAndCount(reject, observable, cb) {\n  // Use a Promise queue to prevent callbacks from being run out of order.\n  var queue = Promise.resolve();\n  var handleCount = 0;\n  var subscription = asyncMap(observable, function (result) {\n    // All previous asynchronous callbacks must complete before cb can\n    // be invoked with this result.\n    return queue = queue.then(function () {\n      return cb(++handleCount, result);\n    }).catch(error);\n  }).subscribe({\n    error: error\n  });\n  function error(e) {\n    subscription.unsubscribe();\n    reject(e);\n  }\n  return subscription;\n}","map":{"version":3,"names":["asyncMap","subscribeAndCount","reject","observable","cb","queue","Promise","resolve","handleCount","subscription","result","then","catch","error","subscribe","e","unsubscribe"],"sources":["C:\\Users\\Simon\\IdeaProjects\\movie-theater-ticket-reservation\\frontend\\node_modules\\@apollo\\src\\testing\\core\\subscribeAndCount.ts"],"sourcesContent":["import type {\n  ObservableSubscription,\n  Observable,\n} from \"../../utilities/index.js\";\nimport { asyncMap } from \"../../utilities/index.js\";\n\nexport default function subscribeAndCount<TResult>(\n  reject: (reason: any) => any,\n  observable: Observable<TResult>,\n  cb: (handleCount: number, result: TResult) => any\n): ObservableSubscription {\n  // Use a Promise queue to prevent callbacks from being run out of order.\n  let queue = Promise.resolve();\n  let handleCount = 0;\n\n  const subscription = asyncMap(observable, (result) => {\n    // All previous asynchronous callbacks must complete before cb can\n    // be invoked with this result.\n    return (queue = queue\n      .then(() => {\n        return cb(++handleCount, result);\n      })\n      .catch(error));\n  }).subscribe({ error });\n\n  function error(e: any) {\n    subscription.unsubscribe();\n    reject(e);\n  }\n\n  return subscription;\n}\n"],"mappings":"AAIA,SAASA,QAAQ,QAAQ,0BAA0B;AAEnD,eAAc,SAAUC,iBAAiBA,CACvCC,MAA4B,EAC5BC,UAA+B,EAC/BC,EAAiD;EAEjD;EACA,IAAIC,KAAK,GAAGC,OAAO,CAACC,OAAO,EAAE;EAC7B,IAAIC,WAAW,GAAG,CAAC;EAEnB,IAAMC,YAAY,GAAGT,QAAQ,CAACG,UAAU,EAAE,UAACO,MAAM;IAC/C;IACA;IACA,OAAQL,KAAK,GAAGA,KAAK,CAClBM,IAAI,CAAC;MACJ,OAAOP,EAAE,CAAC,EAAEI,WAAW,EAAEE,MAAM,CAAC;IAClC,CAAC,CAAC,CACDE,KAAK,CAACC,KAAK,CAAC;EACjB,CAAC,CAAC,CAACC,SAAS,CAAC;IAAED,KAAK,EAAAA;EAAA,CAAE,CAAC;EAEvB,SAASA,KAAKA,CAACE,CAAM;IACnBN,YAAY,CAACO,WAAW,EAAE;IAC1Bd,MAAM,CAACa,CAAC,CAAC;EACX;EAEA,OAAON,YAAY;AACrB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}